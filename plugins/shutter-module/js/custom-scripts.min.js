function getStyleTitle(){var a="";return $("input[name=property_style]:checked").length>0&&(a=$("input[name=property_style]:checked").data("title")),a}function getPropertyMidrailheight(){var a=[];return $("#property_midrailheight").val().length>0&&(a[0]=parseFloat($("#property_midrailheight").val())),a}function getPropertyTotHeight(){var a=0;return""!=$("#property_totheight").val()&&(a=parseInt($("#property_totheight").val())),a}function getPropertyStile(){return $("#property_stile").select2("data")?parseFloat($("#property_stile").select2("data").value):0}function getPropertyBladesize(){return $("#property_bladesize").select2("data")?parseFloat($("#property_bladesize").select2("data").value):0}jQuery("span.js-next-step.next-step, .panel-heading").click(function(){console.log("js-next-step click!"),jQuery(this).hasClass("js-next-step")&&(console.log(jQuery(this).parent().parent().parent().parent()),jQuery(this).parent().parent().parent().parent().addClass("done"),jQuery(this).parent().parent().parent().parent().removeClass("inactive")),jQuery(this).hasClass("panel-heading")&&(console.log("jQuery(this).hasClass('panel-heading')"),jQuery(this).parent().hasClass("inactive")&&(jQuery(this).parent().addClass("done"),jQuery(this).parent().removeClass("inactive")))}),jQuery(".btn.btn-info.show-next-panel").click(function(){var a=jQuery(this).attr("next-panel");console.log(a),jQuery(a).parent().addClass("done"),jQuery(a).parent().removeClass("inactive")});var shutter_type="Shutter";function addError(a,b){$("#"+a).prev().find(".select2-choice").length>0?($("#"+a).prev().addClass("error-field"),$("#"+a).prev().css("display","block"),$("#"+a).closest(".input-group-container").length>0?$('<span class="error-text">'+b+"</span>").insertAfter($("#"+a).closest(".input-group-container")):$('<span class="error-text">'+b+"</span>").insertAfter($("#"+a).after())):($("#"+a).addClass("error-field"),$("#"+a).closest(".input-group-container").length>0?$('<span class="error-text">'+b+"</span>").insertAfter($("#"+a).closest(".input-group-container")):$('<span class="error-text">'+b+"</span>").insertAfter($("#"+a)))}function resetErrors(){$(".error-field").removeClass("error-field"),$("span.error-text").remove()}function modalShowError(a){return jQuery("#errorModal .btn-close").on("click",function(a){jQuery("#errorModal").hide()}),$("#property_nowarranty").prop("checked"),$("#nowarranty").show(),jQuery("#errorModal").show(),jQuery("#errorModal.fade").css("opacity","1"),jQuery("#errorModal .modal-body").html("This shutter is outside of warranty. The following errors have occured: <br/>"+a+"<br/><br/>Either <strong>accept</strong> that there will be no warranty or <strong>change</strong> the configuration. "),!1}function modalShowErrorNoWarranty(a){return jQuery("#errorModal .btn-close").on("click",function(a){jQuery("#errorModal").hide()}),$("#property_nowarranty").prop("checked"),jQuery("#errorModal").show(),jQuery("#errorModal.fade").css("opacity","1"),jQuery("#errorModal .modal-body").html("The following errors have occured: <br/>"+a+"<br/>. "),!1}jQuery("#add-product-single-form .btn-success").on("click",function(_){_.preventDefault(),resetErrors(),jQuery(document).ajaxStart(function(){jQuery(".spinner").show()}),jQuery(document).ajaxComplete(function(){jQuery(".spinner").hide()}),jQuery("#property_layoutcode").val()&&jQuery("#property_layoutcode").val().toUpperCase();var t=jQuery("#property_material").val();jQuery("#property_width").val();var e=jQuery("#property_height").val(),y=jQuery("#property_midrailheight").val(),z=jQuery("#property_midrailheight2").val(),u=jQuery("#property_bladesize").val();console.log(u);var aa=jQuery("#property_room_other").val(),ab=jQuery("input[name=property_stile]:checked").val(),ac=jQuery("input[name=property_solidtype]:checked").val(),S=jQuery("#property_hingecolour").val(),T=jQuery("#property_shuttercolour").val(),A=jQuery("#property_blackoutblindcolour").val(),U=jQuery("#property_controltype").val(),B=jQuery("#property_midraidevider1").val(),C=jQuery("#property_midraidevider2").val(),a=0,k=0,ad=$("#property_nowarranty").prop("checked");if(ad){0==$('input[name="property_style"]:checked').length&&(k++,a++,$("#choose-style").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please select a style for shutter!"),modalShowErrorNoWarranty(error_text="Please select Installation Style")),h=$("input[name=property_style]:checked").data("title"),(0!==u.length||jQuery("#s2id_property_bladesize").is(":hidden"))&&null!==u&&(""!==u|| -1!=h.indexOf("Solid"))||(a++,k++,$("#s2id_property_bladesize").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_bladesize",error_text="Louvre Size is empty"),modalShowErrorNoWarranty(error_text)),0===S.length&&(k++,a++,$("#property_hingecolour").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_hingecolour","Please select hinge colour for shutter!"),modalShowErrorNoWarranty(error_text="Please select hinge colour")),0===T.length&&(k++,a++,$("#property_shuttercolour").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_shuttercolour","Please select shutter colour!"),modalShowErrorNoWarranty(error_text="Please select shutter colour")),"171"==$("input[name=property_frametype]:checked").val()&&(0===A||""===A||null===A)&&(k++,a++,$("#property_blackoutblindcolour").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_blackoutblindcolour","Please select Blackout Blind Colour!"),modalShowErrorNoWarranty(error_text="Please select Blackout Blind Colour")),0!==U.length||jQuery("#s2id_property_controltype").is(":hidden")||(k++,a++,$("#property_controltype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_controltype","Please select control type!"),modalShowErrorNoWarranty(error_text="Please select controltype"));var c=$("#property_layoutcode").val(),l=$("#property_nr_sections").val();if(l){c="";for(var d=1;d<=l;d++){var s="B";l==d&&(s=""),c=c+$("#property_layoutcode"+d).val()+s}console.log("Individual layout_code: "+c)}var F=$("#property_layoutcode_tracked").val();if(0==(c=c?c.toUpperCase():F.toUpperCase()).length&&(k++,a++,$("#property_layoutcode").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please complete with Layout Code!"),modalShowErrorNoWarranty(error_text="Please complete with Layout Code!")),0===k){var N=jQuery("#add-product-single-form").serialize(),O=jQuery("#canvas_container1").html(),G="/wp-content/plugins/shutter-module/ajax/ajax-prod.php",l=$("#property_nr_sections").val();l&&(G="/wp-content/plugins/shutter-module/ajax/ajax-prod-individual.php"),$.ajax({method:"POST",url:G,data:{prod:N,svg:O}}).done(function(a){console.log(a),alert("Shutter added to order! 2");var b=jQuery('input[name="edit_customer"]').val(),c=jQuery('input[name="order_edit"]').val();setTimeout(function(){0!==b.length&&0!==c.length?window.location.replace(document.referrer):window.location.replace("/checkout")},500)})}}else{jQuery("select.required, input.required").each(function(b){""!==jQuery(this).val()&&null!==jQuery(this).val()||jQuery(this).is(":hidden")||(a++,addError(jQuery(this).attr("id"),"Please fill in this field"),modalShowError("Please fill in this field - "+jQuery(this).attr("id")))}),h=$("input[name=property_style]:checked").data("title"),(0!==u.length||jQuery("#s2id_property_bladesize").is(":hidden"))&&null!==u&&(""!==u|| -1!=h.indexOf("Solid"))||(a++,k++,$("#s2id_property_bladesize").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_bladesize",error_text="Louvre Size is empty"),modalShowErrorNoWarranty(error_text)),0!==aa.length||jQuery("#s2id_property_room_other").is(":hidden")||(k++,a++,alert("No room name"),addError("property_room_other",error_text="Room Name is empty"),modalShowErrorNoWarranty(error_text)),0!==ab.length||jQuery("#s2id_property_stile").is(":hidden")||(a++,addError("property_stile",error_text="property stile is empty"),modalShowError(error_text)),null==ac&&"none"!=$("#solidtype").css("display")&&(a++,addError("solidtype",error_text="property stile type is empty"),modalShowError(error_text)),0===S.length&&(a++,addError("property_hingecolour",error_text="Property hingecolour is empty"),modalShowError(error_text)),0===T.length&&(a++,addError("property_shuttercolour",error_text="Property shuttercolour is empty"),modalShowError(error_text));var V=$("#property_shuttercolour").select2("data").value,W=$('input[name="property_stile"]:checked').attr("data-title");(V.includes("brushed")||V.includes("BRUSHED"))&&(void 0===W||W.includes("51mm")||(showErrorModal("Shutter Colour","Brushed Shutter Colour need to have Frame Stile with 51mm. "),a++,addError("property_shuttercolour",error_text="Brushed Shutter Colour need to have Frame Stile with 51mm"),modalShowError(error_text))),"171"==$("input[name=property_frametype]:checked").val()&&(0===A||""===A||null===A)&&(a++,addError("property_blackoutblindcolour",error_text="Property Blackout Blind Colour is empty"),modalShowError(error_text)),0!==U.length||jQuery("#s2id_property_controltype").is(":hidden")||(a++,addError("property_controltype",error_text="Property controltype is empty"),modalShowError(error_text)),(""===t||null===t)&&alert("material must be Selected");var r=parseFloat($("#property_height").val()),h=getStyleTitle(),X=$("#property_controltype").val(),v=parseFloat($("#property_controlsplitheight").val()),H=parseFloat($("#property_controlsplitheight2").val()),g=getPropertyMidrailheight();""==g&&(g=0),isNaN(v)&&(v=0);var I=getPropertyTotHeight(),f="",i=0;-1>h.indexOf("Special")&&(g>1800?(f=f+(error_text="Midrail Height should be below 1800mm")+". ",i++,a++,addError("property_midrailheight",error_text)):g>e-300&&(f=f+(error_text="Midrail Height should be below "+(e-300)+"mm")+". ",i++,a++,addError("property_midrailheight",error_text))),e>=1800&&e<=3e3&& -1==h.indexOf("Tier")&&0==g&& -1>h.indexOf("Combi")&&(""===$("#property_midrailheight").val()||0===$("#property_midrailheight").val())&&($("#property_midrailheight").addClass("required"),f=f+(error_text="Midrail Height should be completed")+". ",i++,a++,addError("property_midrailheight",error_text),modalShowError(error_text)),e>=1800&&e<=3e3&&h.indexOf("Tracked")>=0&&0==g&&($("#property_midrailheight").addClass("required"),f=f+(error_text="Midrail Height should be completed")+". ",i++,a++,addError("property_midrailheight",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&"137"==$("#property_material").val()&&300>parseFloat($("#property_height").val())&&(a++,f=f+(error_text="Height should be at least 300mm")+". ",i++,addError("property_height",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&"187"==$("#property_material").val()&&400>parseFloat($("#property_height").val())&&(a++,f=f+(error_text="Height should be at least 400mm")+". ",i++,addError("property_height",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&250>parseFloat($("#property_height").val())&&(a++,f=f+(error_text="Height should be at least 250mm")+". ",i++,addError("property_height",error_text),modalShowError(error_text));var j=$("input#property_material").val();max_height=2*(panel_height=137==j?1350:1500),h.indexOf("Tier")> -1?r>panel_height&&0==I&&(a++,f+=error_text="T-o-t height required for height more than "+panel_height.toString()+"mm. ",i++,addError("property_totheight",error_text),modalShowError(error_text)):h.indexOf("Solid")> -1?$("#property_midrailheight").removeClass("required"):-1>h.indexOf("Combi")&&r>panel_height&&0==g&&$("#property_midrailheight").hasClass("required")&&(a++,f+=error_text="Midrail height required for height more than "+panel_height.toString()+"mm. ",i++,addError("property_midrailheight",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&parseFloat($("#property_height").val())>max_height&&(a++,f+=error_text="Height should not exceed "+max_height.toString()+"mm. ",i++,addError("property_height",error_text),modalShowError(error_text)),g>0&&g>r-300&&(error_text="Midrail Height should not exceed height of shutter "+(r-300)+"mm. ",a++,addError("property_midrailheight",error_text),modalShowError(error_text)),0==$("input[name=property_frametype]:checked").length&&(a++,$('<span class="error-text">Please select frame type</span>').insertBefore($("#choose-frametype")),addError("property_frametype",error_text="Please select frame type"),modalShowError(error_text)),0==$('input[name="property_style"]:checked').length&&(k++,a++,$("#choose-style").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please select a style for shutter!"),modalShowErrorNoWarranty(error_text="Please select Installation Style"));var c=$("#property_layoutcode").val(),l=$("#property_nr_sections").val();if(l){c="";for(var d=1;d<=l;d++){var s="B";l==d&&(s=""),c=c+$("#property_layoutcode"+d).val()+s}console.log("Individual layout_code: "+c)}var F=$("#property_layoutcode_tracked").val();0==(c=c?c.toUpperCase():F.toUpperCase()).length&&(k++,a++,$("#property_layoutcode").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please complete with Layout Code!"),modalShowErrorNoWarranty(error_text="Please complete with Layout Code!")),0==$('input[name="property_trackedtype"]:checked').length&&35==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select Track Installation type</span>').insertBefore($("#trackedtype")),$("#trackedtype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_trackedtype",error_text="Please select Track Installation type"),modalShowErrorNoWarranty(error_text)),0==$('input[name="property_trackedtype"]:checked').length&&37==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select Track Installation type</span>').insertBefore($("#trackedtype")),$("#trackedtype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_trackedtype",error_text="Please select Track Installation type"),modalShowErrorNoWarranty(error_text)),0==$('input[name="property_bypasstype"]:checked').length&&37==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select By-pass Type</span>').insertBefore($("#bypasstype")),$("#bypasstype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_bypasstype",error_text="Please select By-pass Type"),modalShowErrorNoWarranty(error_text)),0==$('input[name="property_lightblocks"]:checked').length&&37==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select Light Blocks</span>').insertBefore($("#lightblocks")),$("#lightblocks").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_lightblocks",error_text="Please select Light Blocks"),modalShowErrorNoWarranty(error_text));var c=$("#property_layoutcode").val(),l=$("#property_nr_sections").val();if(l){c="";for(var d=1;d<=l;d++){var s="B";l==d&&(s=""),c=c+$("#property_layoutcode"+d).val()+s}console.log("Individual layout_code: "+c)}var F=$("#property_layoutcode_tracked").val(),J=0,n=0;c=c?c.toUpperCase():F.toUpperCase(),counter=0,last_char="",total_panels=0,all_panels=0,tracked_layout_error=!1;var j=$("input#property_material").val(),w=$("input#property_bladesize").val();panel2_width=550,panel2_width=625,panel2_width=625,panel3_width=550,panel2_width=625,panel3_width=550,panel3_width=550;for(var b={panels1:0,panels2:0,panels3:0,multiPanels:0},p="",K="",d=0;d<c.length;d++)all_panels++,0===d&&(p=c.charAt(d)),K=c.charAt(d),console.log("======================================"),console.log("currentCharacter "+K),console.log("lastCharacter "+p),h.indexOf("Tracked")> -1?(b.multiPanels=b.multiPanels+1,console.log("Total Panels finded Tracked : "+total_panels)):"L"!=c.charAt(d)&&"R"!=c.charAt(d)?(last_char=c.charAt(d),console.log("Last Char "+last_char),console.log("Total Panels finded : "+total_panels),console.log("TOTAL PANELS BCTG "+total_panels),console.log(b),console.log("reset total"),total_panels=0,p=c.charAt(d)):K!==p&&0>"BCTG".indexOf(p)?(console.log("Total Panels finded : "+total_panels),console.log("add to array panel1 !!! "),b.panels1=b.panels1+1,total_panels=1,console.log("TOTAL PANELS RL "+b.panels1),console.log(b),console.log("reset total"),p=c.charAt(d)):K!==p&&"BCTG".indexOf(p)>=0?(console.log("add to array panel1 !!! "),console.log(b.panels1),b.panels1=b.panels1+1,total_panels=1,p=c.charAt(d)):(total_panels++,p=c.charAt(d),2===total_panels?(b.panels2=b.panels2+total_panels,console.log("reset arrayPanels1"),b.panels1=b.panels1-1):3===total_panels?(b.panels3=b.panels3+total_panels,console.log("reset arrayPanels2"),b.panels2=b.panels2-(total_panels-1)):total_panels>3&&(b.multiPanels=b.multiPanels+total_panels,console.log("reset arrayPanels3"),b.panels3=b.panels3-(total_panels-1)),0==d&&(b.panels1=1),console.log("TOTAL PANELS same "+total_panels),console.log(b),p=c.charAt(d)),multipanel_singlepanel_width=$("input#property_width").val()/total_panels;console.log(b),n=0,width_shutter=jQuery("#property_width").val();var l=$("#property_nr_sections").val();if(l){width_shutter=0;for(var d=1;d<=l;d++)width_shutter+=parseFloat($("#property_width"+d).val());console.log("width_shutter: "+width_shutter)}if(b.panels1>0){var o=750;187==j&&(o=1500),(139==j||138==j)&&(o=890),(188==j||137==j)&&(o=850),h.indexOf("Solid")> -1&&(o=550),n+=b.panels1*o}if(b.panels2>0){var q=550;(138==j||139==j)&&(q=625),137==j&&(q=500),h.indexOf("Solid")> -1&&(q=550),n+=b.panels2*q}if(b.panels3>0){var q=550;(138==j||139==j)&&(q=625),137==j&&(q=500),h.indexOf("Solid")> -1&&(q=550),n+=b.panels3*q,console.log("arrayPanels.panels3 > 0")}if(b.multiPanels>0){var o=750;187==j&&(o=1500),(139==j||138==j)&&(o=890),(188==j||137==j)&&(o=850),h.indexOf("Solid")> -1&&(o=550),n=b.panels1*o,h.indexOf("Tracked")> -1||(error_text="<br/>Layout code is invalid. No more than 3 consecutive "+last_char+" panels allowed.",a++,i++,f+=error_text,addError("property_layoutcode",error_text),modalShowError(error_text))}if(-1==h.indexOf("Tracked")&&(b.panels1>0&&0===b.panels2&&0===b.panels3&&0===b.multiPanels&&(n<width_shutter&&(console.log("width shutter: "+width_shutter+" width panels max "+n),error_text="<br/>Max width for single panel too high. Max width "+o,a++,addError("property_layoutcode",error_text),modalShowError(error_text)),width_shutter/b.panels1<200&&(error_text="<br/>Min width for single panel too low.",a++,addError("property_layoutcode",error_text),modalShowError(error_text))),(b.panels2>0||b.panels3>0&&0===b.multiPanels)&&(n<width_shutter&&(error_text="<br/>Max width for multi-fold panels too high.",a++,console.log("current_max_width: "+n),addError("property_layoutcode",error_text),modalShowError(error_text)),width_shutter/b.panels1+width_shutter/b.panels2+width_shutter/b.panels3<200&&(error_text="<br/>Min width for multi-fold panels too low.",a++,addError("property_layoutcode",error_text),modalShowError(error_text)))),h.indexOf("Tracked")> -1){var q=890;n=b.multiPanels*q,console.log("current_max_width: "+n),n<width_shutter&&(error_text="<br/>Max width for single panel too high.",a++,addError("property_layoutcode",error_text),modalShowError(error_text)),width_shutter/b.multiPanels<200&&(error_text="<br/>Min width for multi-fold panels too low.",a++,addError("property_layoutcode",error_text),modalShowError(error_text)),h.indexOf("Tracked")> -1&&b.multiPanels%2!=0&&(tracked_layout_error=!0),tracked_layout_error&&(a++,addError("property_layoutcode","Tracked shutters require even number of panels per layout code 22"),modalShowError(error_text="Tracked shutters require even number of panels per layout code"))}J=200*all_panels,137==j&&(J=250*all_panels,h.indexOf("Tracked")),""!=width_shutter&&width_shutter<J&&(a++,f+=error_text="Width should be at least "+J+"mm. ",i++,addError("property_width",error_text),modalShowError(error_text)),"Blackout"==shutter_type&&0==(c.match(/t/ig)||[]).length&&0==(c.match(/b/ig)||[]).length&&0==(c.match(/c/ig)||[]).length&&width_shutter>1400&&(a++,addError("property_layoutcode","Shutter and Blackout Blind require a T-post if width is more than 1400mm")),!($indiv=$("#property_nr_sections").val())&&(c.indexOf("B")>0||c.indexOf("C")>0)&& -1==h.indexOf("Bay")&& -1==h.indexOf("Tracked")&&(a++,console.log("errors: "+a),addError("property_layoutcode","Please choose Bay Window style with a layout code containing B or C."));var w=$("input#property_bladesize").val();if("96"==X||"95"==X){var m,L=!1,Y=!1,D=0,E=0,P=0,Q=0;if("47"==w&&(m=890,g>0&&(m=890)),"63"==w&&(m=890,g>0&&(m=890)),"76"==w&&(m=890,g>0&&(m=890)),"89"==w&&(m=890,g>0&&(m=890)),"187"==j&&(m=1500),0==g&&0==I&&r>m)D=0,E=m,L=!0;else if(g>0||I>0){var x=0;g>0&&(x=parseInt(g)),I>0&&(x=parseInt(I));var M=x,Z=r-M;M>m&&Z>m?(L=!0,Y=!0,D=0,E=x,P=x+1,Q=r):(M>m||Z>m)&&(L=!0,M>m?(D=0,E=x):(D=x+1,E=r))}if(g>0&&v>0){var R=Math.abs(g-v);R<=10&&(error_text="<br/>Distance between split height and midrail should be more than 10mm",a++,i++,f+=error_text,addError("property_controlsplitheight",error_text))}if(g>0&&parseInt(H)>0){var R=Math.abs(g-parseInt(H));R<=10&&(error_text="<br/>Distance between split height 2 and midrail should be more than 10mm",a++,i++,f+=error_text,addError("property_controlsplitheight2",error_text))}L&&($("#property_controltype").select2("val",95),$("#control-split-height").show(),0==parseInt(v)&&(error_text="<br/>Split height is required for "+w+"mm and height "+r+"mm",a++,i++,f+=error_text,addError("property_controlsplitheight",error_text)),v>E&&(error_text="<br/>Split height should be less than "+E+"mm",a++,i++,f+=error_text,addError("property_controlsplitheight",error_text)),v<D&&(error_text="<br/>Split height should be more than "+D+"mm",a++,i++,f+=error_text,addError("property_controlsplitheight",error_text))),Y?($("#property_controltype").select2("val",95),$("#control-split-height").show(),$("#property_controlsplitheight2").show(),0==parseInt(H)&&(error_text="<br/>Second split height is required for "+w+"mm and height "+r+"mm",a++,i++,f+=error_text,addError("property_controlsplitheight2",error_text)),H>Q&&(error_text="<br/>Second split height should be less than "+Q+"mm",a++,i++,f+=error_text,addError("property_controlsplitheight2",error_text)),H<P&&(error_text="<br/>Second split height should be more than "+P+"mm",a++,i++,f+=error_text,addError("property_controlsplitheight2",error_text))):$("#property_controlsplitheight2").hide()}if($("input[name=property_style]:checked").length>0&&(h=$("input[name=property_style]:checked").data("title")).indexOf("Shaped")> -1&&(existingShapeFile=$("#provided-shape").html().trim(),newShapeFile=$("#attachment").val(),newDrawFile=$("#attachment_draw").val(),""==existingShapeFile&&""==newShapeFile&&""==newDrawFile&&(a++,addError("shape-upload-container",'Please provide the desired shape for style "Shaped & French Cut Out"'))),$("#canvas_container1 svg").length>0&&$("#shutter_svg").html($("#canvas_container1").html()),139==t||138==t||188==t?(y>1800&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than 1800")),y>e-300&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than "+e-300)),z>2700&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than 2700")),z>e-300&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than "+e-300)),B>3e3&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than 3000")),B>e-300&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than "+e-300)),C>3e3&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than 3000")),C>e-300&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than "+e-300))):137==t?(y>1500&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than 1500")),y>e-300&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than "+e-300)),z>2400&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than 2400")),z>e-300&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than "+e-300)),B>2700&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than 2700")),B>e-300&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than "+e-300)),C>2700&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than 2700")),C>e-300&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than "+e-300))):187==t&&(y>1500&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than 1500")),y>e-300&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than "+e-300)),z>2700&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than 2700")),z>e-300&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than "+e-300)),B>3e3&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than 3000")),B>e-300&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than "+e-300)),C>3e3&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than 3000")),C>e-300&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than "+e-300))),console.log("errors "+k),console.log("errors_no_warranty "+k),0===a&&0===k){var N=jQuery("#add-product-single-form").serialize(),O=jQuery("#canvas_container1").html(),G="/wp-content/plugins/shutter-module/ajax/ajax-prod.php",l=$("#property_nr_sections").val();l&&(G="/wp-content/plugins/shutter-module/ajax/ajax-prod-individual.php"),$.ajax({method:"POST",url:G,data:{prod:N,svg:O}}).done(function(a){console.log(a),alert("Shutter added to order! 1");var b=jQuery('input[name="edit_customer"]').val(),c=jQuery('input[name="order_edit"]').val();setTimeout(function(){0!==b.length&&0!==c.length?window.location.replace(document.referrer):window.location.replace("/checkout")},500)})}}}),jQuery("#add-product-single-form .update-btn").on("click",function(_){_.preventDefault(),resetErrors(),console.log("in update cusrom-script"),jQuery(document).ajaxStart(function(){jQuery(".spinner").show()}),jQuery(document).ajaxComplete(function(){jQuery(".spinner").hide()}),jQuery("#property_layoutcode").val()&&jQuery("#property_layoutcode").val().toUpperCase();var t=jQuery("#property_material").val();jQuery("#property_width").val();var e=jQuery("#property_height").val(),y=jQuery("#property_midrailheight").val(),z=jQuery("#property_midrailheight2").val(),u=jQuery("#property_bladesize").val();console.log(u);var aa=jQuery("#property_room_other").val(),ab=jQuery("input[name=property_stile]:checked").val(),ac=jQuery("input[name=property_solidtype]:checked").val(),S=jQuery("#property_hingecolour").val(),T=jQuery("#property_shuttercolour").val(),A=jQuery("#property_blackoutblindcolour").val(),U=jQuery("#property_controltype").val(),B=jQuery("#property_midraidevider1").val(),C=jQuery("#property_midraidevider2").val(),a=0,k=0,ad=$("#property_nowarranty").prop("checked");if(ad){0==$('input[name="property_style"]:checked').length&&(k++,a++,$("#choose-style").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please select a style for shutter!"),modalShowErrorNoWarranty(error_text="Please select Installation Style")),j=$("input[name=property_style]:checked").data("title"),(0!==u.length||jQuery("#s2id_property_bladesize").is(":hidden"))&&null!==u&&(""!==u|| -1!=j.indexOf("Solid"))||(a++,k++,$("#s2id_property_bladesize").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_bladesize",error_text="Louvre Size is empty"),modalShowErrorNoWarranty(error_text));var c=$("#property_layoutcode").val(),l=$("#property_nr_sections").val();if(l){c="";for(var d=1;d<=l;d++){var s="B";l==d&&(s=""),c=c+$("#property_layoutcode"+d).val()+s}console.log("Individual layout_code: "+c)}var F=$("#property_layoutcode_tracked").val();if(0==(c=c?c.toUpperCase():F.toUpperCase()).length&&(k++,a++,$("#property_layoutcode").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please complete with Layout Code!"),modalShowErrorNoWarranty(error_text="Please complete with Layout Code!")),0===S.length&&(k++,a++,$("#property_hingecolour").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_hingecolour","Please select hinge colour for shutter!"),modalShowErrorNoWarranty(error_text="Please select hinge colour")),0===T.length&&(k++,a++,$("#property_shuttercolour").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_shuttercolour","Please select shutter colour!"),modalShowErrorNoWarranty(error_text="Please select shutter colour")),"171"==$("input[name=property_frametype]:checked").val()&&(0===A||""===A||null===A)&&(k++,a++,$("#property_blackoutblindcolour").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_blackoutblindcolour","Please select Blackout Blind Colour!"),modalShowErrorNoWarranty(error_text="Please select Blackout Blind Colour")),0!==U.length||jQuery("#s2id_property_controltype").is(":hidden")||(k++,a++,$("#property_controltype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_controltype","Please select control type!"),modalShowErrorNoWarranty(error_text="Please select controltype")),0===k){var N=jQuery("#add-product-single-form").serialize(),O=jQuery("#canvas_container1").html(),G="/wp-content/plugins/shutter-module/ajax/ajax-prod-update.php",l=$("#property_nr_sections").val();l&&(G="/wp-content/plugins/shutter-module/ajax/ajax-prod-update-individual.php"),$.ajax({method:"POST",url:G,data:{prod:N,svg:O}}).done(function(a){console.log(a),alert("Shutter updated to order! 4");var b=jQuery('input[name="edit_customer"]').val(),c=jQuery('input[name="order_edit"]').val();setTimeout(function(){0!==b.length&&0!==c.length?window.location.replace(document.referrer):window.location.replace("/checkout")},500)})}}else{jQuery("select.required, input.required").each(function(b){""!==jQuery(this).val()&&null!==jQuery(this).val()||jQuery(this).is(":hidden")||(a++,addError(jQuery(this).attr("id"),"Please fill in this field"),modalShowError("Please fill in this field - "+jQuery(this).attr("id")))}),j=$("input[name=property_style]:checked").data("title"),(0!==u.length||jQuery("#s2id_property_bladesize").is(":hidden"))&&null!==u&&(""!==u|| -1!=j.indexOf("Solid"))||(a++,k++,$("#s2id_property_bladesize").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_bladesize",error_text="Louvre Size is empty"),modalShowErrorNoWarranty(error_text)),0!==aa.length||jQuery("#s2id_property_room_other").is(":hidden")||(k++,a++,alert("No room name"),addError("property_room_other",error_text="Room Name is empty"),modalShowErrorNoWarranty(error_text)),0!==ab.length||jQuery("#s2id_property_stile").is(":hidden")||(a++,addError("property_stile",error_text="property stile is empty"),modalShowError(error_text)),null==ac&&"none"!=$("#solidtype").css("display")&&(a++,addError("solidtype",error_text="property stile type is empty"),modalShowError(error_text)),0===S.length&&(a++,addError("property_hingecolour",error_text="Property hingecolour is empty"),modalShowError(error_text)),0===T.length&&(a++,addError("property_shuttercolour",error_text="Property shuttercolour is empty"),modalShowError(error_text));var V=$("#property_shuttercolour").select2("data").value,W=$('input[name="property_stile"]:checked').attr("data-title");(V.includes("brushed")||V.includes("BRUSHED"))&&(void 0===W||W.includes("51mm")||(showErrorModal("Shutter Colour","Brushed Shutter Colour need to have Frame Stile with 51mm. "),a++,addError("property_shuttercolour",error_text="Brushed Shutter Colour need to have Frame Stile with 51mm"),modalShowError(error_text))),"171"==$("input[name=property_frametype]:checked").val()&&(0===A||""===A||null===A)&&(a++,addError("property_blackoutblindcolour",error_text="Property Blackout Blind Colour is empty"),modalShowError(error_text)),0===U.length&&!jQuery("#s2id_property_controltype").is(":hidden")&&jQuery("#s2id_property_controltype").hasClass("required")&&(a++,addError("property_controltype",error_text="Property controltype is empty"),modalShowError(error_text)),(""===t||null===t)&&alert("material must be Selected");var r=parseFloat($("#property_height").val()),j=getStyleTitle(),X=$("#property_controltype").val(),v=parseFloat($("#property_controlsplitheight").val()),H=parseFloat($("#property_controlsplitheight2").val()),g=getPropertyMidrailheight();""==g&&(g=0),isNaN(v)&&(v=0);var I=getPropertyTotHeight(),f="",h=0;-1>j.indexOf("Special")&&(g>1800?(f=f+(error_text="Midrail Height should be below 1800mm")+". ",h++,a++,addError("property_midrailheight",error_text)):g>e-300&&(f=f+(error_text="Midrail Height should be below "+(e-300)+"mm")+". ",h++,a++,addError("property_midrailheight",error_text))),e>=1800&&e<=3e3&& -1==j.indexOf("Tier")&&0==g&& -1>j.indexOf("Combi")&&(""===$("#property_midrailheight").val()||0===$("#property_midrailheight").val())&&($("#property_midrailheight").addClass("required"),f=f+(error_text="Midrail Height should be completed")+". ",h++,a++,addError("property_midrailheight",error_text),modalShowError(error_text)),e>=1800&&e<=3e3&&j.indexOf("Tracked")>=0&&0==g&&($("#property_midrailheight").addClass("required"),f=f+(error_text="Midrail Height should be completed")+". ",h++,a++,addError("property_midrailheight",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&"137"==$("#property_material").val()&&300>parseFloat($("#property_height").val())&&(a++,f=f+(error_text="Height should be at least 300mm")+". ",h++,addError("property_height",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&"187"==$("#property_material").val()&&400>parseFloat($("#property_height").val())&&(a++,f=f+(error_text="Height should be at least 400mm")+". ",h++,addError("property_height",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&250>parseFloat($("#property_height").val())&&(a++,f=f+(error_text="Height should be at least 250mm")+". ",h++,addError("property_height",error_text),modalShowError(error_text));var i=$("input#property_material").val();max_height=2*(panel_height=137==i?1350:1500),j.indexOf("Tier")> -1?r>panel_height&&0==I&&(a++,f+=error_text="T-o-t height required for height more than "+panel_height.toString()+"mm. ",h++,addError("property_totheight",error_text),modalShowError(error_text)):j.indexOf("Solid")> -1?$("#property_midrailheight").removeClass("required"):-1>j.indexOf("Combi")&&r>panel_height&&0==g&&$("#property_midrailheight").hasClass("required")&&(a++,f+=error_text="Midrail height required for height more than "+panel_height.toString()+"mm. ",h++,addError("property_midrailheight",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&parseFloat($("#property_height").val())>max_height&&(a++,f+=error_text="Height should not exceed "+max_height.toString()+"mm. ",h++,addError("property_height",error_text),modalShowError(error_text)),g>0&&g>r-300&&(error_text="Midrail Height should not exceed height of shutter "+(r-300)+"mm. ",a++,addError("property_midrailheight",error_text),modalShowError(error_text)),0==$("input[name=property_frametype]:checked").length&&(a++,$('<span class="error-text">Please select frame type</span>').insertBefore($("#choose-frametype")),addError("property_frametype",error_text="Please select frame type"),modalShowError(error_text)),0==$('input[name="property_style"]:checked').length&&(k++,a++,$("#choose-style").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please select a style for shutter!"),modalShowErrorNoWarranty(error_text="Please select Installation Style"));var c=$("#property_layoutcode").val(),l=$("#property_nr_sections").val();if(l){c="";for(var d=1;d<=l;d++){var s="B";l==d&&(s=""),c=c+$("#property_layoutcode"+d).val()+s}console.log("Individual layout_code: "+c)}var F=$("#property_layoutcode_tracked").val();0==(c=c?c.toUpperCase():F.toUpperCase()).length&&(k++,a++,$("#property_layoutcode").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please complete with Layout Code!"),modalShowErrorNoWarranty(error_text="Please complete with Layout Code!")),0==$('input[name="property_trackedtype"]:checked').length&&35==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select Track Installation type</span>').insertBefore($("#trackedtype")),$("#trackedtype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_trackedtype",error_text="Please select Track Installation type"),modalShowErrorNoWarranty(error_text)),0==$('input[name="property_trackedtype"]:checked').length&&37==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select Track Installation type</span>').insertBefore($("#trackedtype")),$("#trackedtype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_trackedtype",error_text="Please select Track Installation type"),modalShowErrorNoWarranty(error_text)),0==$('input[name="property_bypasstype"]:checked').length&&37==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select By-pass Type</span>').insertBefore($("#bypasstype")),$("#bypasstype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_bypasstype",error_text="Please select By-pass Type"),modalShowErrorNoWarranty(error_text)),0==$('input[name="property_lightblocks"]:checked').length&&37==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select Light Blocks</span>').insertBefore($("#lightblocks")),$("#lightblocks").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_lightblocks",error_text="Please select Light Blocks"),modalShowErrorNoWarranty(error_text));var c=$("#property_layoutcode").val(),l=$("#property_nr_sections").val();if(l){c="";for(var d=1;d<=l;d++){var s="B";l==d&&(s=""),c=c+$("#property_layoutcode"+d).val()+s}console.log("Individual layout_code: "+c)}var F=$("#property_layoutcode_tracked").val(),J=0,n=0;c=c?c.toUpperCase():F.toUpperCase(),counter=0,last_char="",total_panels=0,all_panels=0,tracked_layout_error=!1;var i=$("input#property_material").val(),w=$("input#property_bladesize").val();panel2_width=550,panel2_width=625,panel2_width=625,panel3_width=550,panel2_width=625,panel3_width=550,panel3_width=550;for(var b={panels1:0,panels2:0,panels3:0,multiPanels:0},p="",K="",d=0;d<c.length;d++)all_panels++,0===d&&(p=c.charAt(d)),K=c.charAt(d),console.log("======================================"),console.log("currentCharacter "+K),console.log("lastCharacter "+p),j.indexOf("Tracked")> -1?(b.multiPanels=b.multiPanels+1,console.log("Total Panels finded Tracked : "+total_panels)):"L"!=c.charAt(d)&&"R"!=c.charAt(d)?(last_char=c.charAt(d),console.log("Last Char "+last_char),console.log("Total Panels finded : "+total_panels),console.log("TOTAL PANELS BCTG "+total_panels),console.log(b),console.log("reset total"),total_panels=0,p=c.charAt(d)):K!==p&&0>"BCTG".indexOf(p)?(console.log("Total Panels finded : "+total_panels),console.log("add to array panel1 !!! "),b.panels1=b.panels1+1,total_panels=1,console.log("TOTAL PANELS RL "+b.panels1),console.log(b),console.log("reset total"),p=c.charAt(d)):K!==p&&"BCTG".indexOf(p)>=0?(console.log("add to array panel1 !!! "),console.log(b.panels1),b.panels1=b.panels1+1,total_panels=1,p=c.charAt(d)):(total_panels++,p=c.charAt(d),2===total_panels?(b.panels2=b.panels2+total_panels,console.log("reset arrayPanels1"),b.panels1=b.panels1-1):3===total_panels?(b.panels3=b.panels3+total_panels,console.log("reset arrayPanels2"),b.panels2=b.panels2-(total_panels-1)):total_panels>3&&(b.multiPanels=b.multiPanels+total_panels,console.log("reset arrayPanels3"),b.panels3=b.panels3-(total_panels-1)),0==d&&(b.panels1=1),console.log("TOTAL PANELS same "+total_panels),console.log(b),p=c.charAt(d)),multipanel_singlepanel_width=$("input#property_width").val()/total_panels;console.log(b),n=0,width_shutter=jQuery("#property_width").val();var l=$("#property_nr_sections").val();if(l){width_shutter=0;for(var d=1;d<=l;d++)width_shutter+=parseFloat($("#property_width"+d).val());console.log("width_shutter: "+width_shutter)}if(b.panels1>0){var o=750;187==i&&(o=1500),(139==i||138==i)&&(o=890),(188==i||137==i)&&(o=850),j.indexOf("Solid")> -1&&(o=550),n+=b.panels1*o}if(b.panels2>0){var q=550;(138==i||139==i)&&(q=625),137==i&&(q=500),j.indexOf("Solid")> -1&&(q=550),n+=b.panels2*q}if(b.panels3>0){var q=550;(138==i||139==i)&&(q=625),137==i&&(q=500),j.indexOf("Solid")> -1&&(q=550),n+=b.panels3*q,console.log("arrayPanels.panels3 > 0")}if(b.multiPanels>0){console.log("arrayPanels.multiPanels > 0");var o=750;187==i&&(o=1500),(139==i||138==i)&&(o=890),(188==i||137==i)&&(o=850),j.indexOf("Solid")> -1&&(o=550),n=b.panels1*o,j.indexOf("Tracked")> -1||(error_text="<br/>Layout code is invalid. No more than 3 consecutive "+last_char+" panels allowed.",a++,h++,f+=error_text,addError("property_layoutcode",error_text),modalShowError(error_text))}if(-1==j.indexOf("Tracked")&&(b.panels1>0&&0===b.panels2&&0===b.panels3&&0===b.multiPanels&&(n<width_shutter&&(console.log("width shutter: "+width_shutter+" width panels max "+n),error_text="<br/>Max width for single panel too high. Max width "+o,a++,addError("property_layoutcode",error_text),modalShowError(error_text)),width_shutter/b.panels1<200&&(error_text="<br/>Min width for single panel too low.",a++,addError("property_layoutcode",error_text),modalShowError(error_text))),(b.panels2>0||b.panels3>0&&0===b.multiPanels)&&(n<width_shutter&&(error_text="<br/>Max width for multi-fold panels too high.",a++,console.log("current_max_width: "+n),addError("property_layoutcode",error_text),modalShowError(error_text)),width_shutter/b.panels1+width_shutter/b.panels2+width_shutter/b.panels3<200&&(error_text="<br/>Min width for multi-fold panels too low.",a++,addError("property_layoutcode",error_text),modalShowError(error_text)))),j.indexOf("Tracked")> -1){var q=890;n=b.multiPanels*q,console.log("current_max_width: "+n),n<width_shutter&&(error_text="<br/>Max width for single panel too high.",a++,addError("property_layoutcode",error_text),modalShowError(error_text)),width_shutter/b.multiPanels<200&&(error_text="<br/>Min width for multi-fold panels too low.",a++,addError("property_layoutcode",error_text),modalShowError(error_text)),j.indexOf("Tracked")> -1&&b.multiPanels%2!=0&&(tracked_layout_error=!0),tracked_layout_error&&(a++,addError("property_layoutcode","Tracked shutters require even number of panels per layout code 22"),modalShowError(error_text="Tracked shutters require even number of panels per layout code"))}J=200*all_panels,137==i&&(J=250*all_panels),""!=width_shutter&&width_shutter<J&&(a++,f+=error_text="Width should be at least "+J+"mm. ",h++,addError("property_width",error_text),modalShowError(error_text)),"Blackout"==shutter_type&&0==(c.match(/t/ig)||[]).length&&0==(c.match(/b/ig)||[]).length&&0==(c.match(/c/ig)||[]).length&&width_shutter>1400&&(a++,addError("property_layoutcode","Shutter and Blackout Blind require a T-post if width is more than 1400mm")),!($indiv=$("#property_nr_sections").val())&&(c.indexOf("B")>0||c.indexOf("C")>0)&& -1==j.indexOf("Bay")&& -1==j.indexOf("Tracked")&&(a++,console.log("errors: "+a),addError("property_layoutcode","Please choose Bay Window style with a layout code containing B or C."));var w=$("input#property_bladesize").val();if("96"==X||"95"==X){var m,L=!1,Y=!1,D=0,E=0,P=0,Q=0;if("47"==w&&(m=890,g>0&&(m=890)),"63"==w&&(m=890,g>0&&(m=890)),"76"==w&&(m=890,g>0&&(m=890)),"89"==w&&(m=890,g>0&&(m=890)),"187"==i&&(m=1500),0==g&&0==I&&r>m)D=0,E=m,L=!0;else if(g>0||I>0){var x=0;g>0&&(x=parseInt(g)),I>0&&(x=parseInt(I));var M=x,Z=r-M;M>m&&Z>m?(L=!0,Y=!0,D=0,E=x,P=x+1,Q=r):(M>m||Z>m)&&(L=!0,M>m?(D=0,E=x):(D=x+1,E=r))}if(g>0&&v>0){var R=Math.abs(g-v);R<=10&&(error_text="<br/>Distance between split height and midrail should be more than 10mm",a++,h++,f+=error_text,addError("property_controlsplitheight",error_text))}if(g>0&&parseInt(H)>0){var R=Math.abs(g-parseInt(H));R<=10&&(error_text="<br/>Distance between split height 2 and midrail should be more than 10mm",a++,h++,f+=error_text,addError("property_controlsplitheight2",error_text))}L&&($("#property_controltype").select2("val",95),$("#control-split-height").show(),0==parseInt(v)&&(error_text="<br/>Split height is required for "+w+"mm and height "+r+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight",error_text)),v>E&&(error_text="<br/>Split height should be less than "+E+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight",error_text)),v<D&&(error_text="<br/>Split height should be more than "+D+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight",error_text))),Y?($("#property_controltype").select2("val",95),$("#control-split-height").show(),$("#property_controlsplitheight2").show(),0==parseInt(H)&&(error_text="<br/>Second split height is required for "+w+"mm and height "+r+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight2",error_text)),H>Q&&(error_text="<br/>Second split height should be less than "+Q+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight2",error_text)),H<P&&(error_text="<br/>Second split height should be more than "+P+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight2",error_text))):$("#property_controlsplitheight2").hide()}if($("input[name=property_style]:checked").length>0&&(j=$("input[name=property_style]:checked").data("title")).indexOf("Shaped")> -1&&(existingShapeFile=$("#provided-shape").html().trim(),newShapeFile=$("#attachment").val(),newDrawFile=$("#attachment_draw").val(),""==existingShapeFile&&""==newShapeFile&&""==newDrawFile&&(a++,addError("shape-upload-container",'Please provide the desired shape for style "Shaped & French Cut Out"'))),$("#canvas_container1 svg").length>0&&$("#shutter_svg").html($("#canvas_container1").html()),139==t||138==t||188==t?(y>1800&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than 1800")),y>e-300&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than "+e-300)),z>2700&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than 2700")),z>e-300&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than "+e-300)),B>3e3&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than 3000")),B>e-300&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than "+e-300)),C>3e3&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than 3000")),C>e-300&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than "+e-300))):137==t?(y>1500&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than 1500")),y>e-300&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than "+e-300)),z>2400&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than 2400")),z>e-300&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than "+e-300)),B>2700&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than 2700")),B>e-300&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than "+e-300)),C>2700&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than 2700")),C>e-300&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than "+e-300))):187==t&&(y>1500&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than 1500")),y>e-300&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than "+e-300)),z>2700&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than 2700")),z>e-300&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than "+e-300)),B>3e3&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than 3000")),B>e-300&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than "+e-300)),C>3e3&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than 3000")),C>e-300&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than "+e-300))),console.log("errors_no_warranty "+k),0===a&&0===k){var N=jQuery("#add-product-single-form").serialize(),O=jQuery("#canvas_container1").html(),G="/wp-content/plugins/shutter-module/ajax/ajax-prod-update.php",l=$("#property_nr_sections").val();l&&(G="/wp-content/plugins/shutter-module/ajax/ajax-prod-update-individual.php"),$.ajax({method:"POST",url:G,data:{prod:N,svg:O}}).done(function(a){console.log(a),alert("Shutter updated to order! 3");var b=jQuery('input[name="edit_customer"]').val(),c=jQuery('input[name="order_edit"]').val();setTimeout(function(){0!==b.length&&0!==c.length?window.location.replace(document.referrer):window.location.replace("/checkout")},500)})}}$.getJSON("/wp-content/plugins/shutter-module/ajax/shutter-values.php",function(){}).done(function(a){localStorage.setItem("prop_val",JSON.stringify(a));var b=JSON.stringify(a);return sessionStorage.prop_val=JSON.stringify(a),b}),localStorage.getItem("prop_val")}),jQuery("#add-product-single-form .update-btn-admin").on("click",function(_){_.preventDefault(),resetErrors(),jQuery(document).ajaxStart(function(){jQuery(".spinner").show()}),jQuery(document).ajaxComplete(function(){jQuery(".spinner").hide()}),jQuery("#property_layoutcode").val()&&jQuery("#property_layoutcode").val().toUpperCase();var t=jQuery("#property_material").val();jQuery("#property_width").val();var e=jQuery("#property_height").val(),y=jQuery("#property_midrailheight").val(),z=jQuery("#property_midrailheight2").val(),u=jQuery("#property_bladesize").val();console.log(u);var aa=jQuery("#property_room_other").val(),ab=jQuery("input[name=property_stile]:checked").val(),ac=jQuery("input[name=property_solidtype]:checked").val(),S=jQuery("#property_hingecolour").val(),T=jQuery("#property_shuttercolour").val(),A=jQuery("#property_blackoutblindcolour").val(),U=jQuery("#property_controltype").val(),B=jQuery("#property_midraidevider1").val(),C=jQuery("#property_midraidevider2").val(),a=0,k=0,ad=$("#property_nowarranty").prop("checked");if(ad){0==$('input[name="property_style"]:checked').length&&(k++,a++,$("#choose-style").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please select a style for shutter!"),modalShowErrorNoWarranty(error_text="Please select Installation Style")),j=$("input[name=property_style]:checked").data("title"),(0!==u.length||jQuery("#s2id_property_bladesize").is(":hidden"))&&null!==u&&(""!==u|| -1!=j.indexOf("Solid"))||(a++,k++,$("#s2id_property_bladesize").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_bladesize",error_text="Louvre Size is empty"),modalShowErrorNoWarranty(error_text));var c=$("#property_layoutcode").val(),l=$("#property_nr_sections").val();if(l){c="";for(var d=1;d<=l;d++){var s="B";l==d&&(s=""),c=c+$("#property_layoutcode"+d).val()+s}console.log("Individual layout_code: "+c)}var F=$("#property_layoutcode_tracked").val();if(0==(c=c?c.toUpperCase():F.toUpperCase()).length&&(k++,a++,$("#property_layoutcode").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please complete with Layout Code!"),modalShowErrorNoWarranty(error_text="Please complete with Layout Code!")),0===S.length&&(k++,a++,$("#property_hingecolour").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_hingecolour","Please select hinge colour for shutter!"),modalShowErrorNoWarranty(error_text="Please select hinge colour")),0===T.length&&(k++,a++,$("#property_shuttercolour").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_shuttercolour","Please select shutter colour!"),modalShowErrorNoWarranty(error_text="Please select shutter colour")),"171"==$("input[name=property_frametype]:checked").val()&&(0===A||""===A||null===A)&&(k++,a++,$("#property_blackoutblindcolour").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_blackoutblindcolour","Please select Blackout Blind Colour!"),modalShowErrorNoWarranty(error_text="Please select Blackout Blind Colour")),0!==U.length||jQuery("#s2id_property_controltype").is(":hidden")||(k++,a++,$("#property_controltype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_controltype","Please select control type!"),modalShowErrorNoWarranty(error_text="Please select controltype")),0===k){var N=jQuery("#add-product-single-form").serialize(),O=jQuery("#canvas_container1").html(),G="/wp-content/plugins/shutter-module/ajax/ajax-prod-update.php",l=$("#property_nr_sections").val();l&&(G="/wp-content/plugins/shutter-module/ajax/ajax-prod-update-individual.php"),$.ajax({method:"POST",url:G,data:{prod:N,svg:O}}).done(function(a){console.log(a),alert("Shutter updated to order! 6"),setTimeout(function(){window.location.replace(document.referrer)},500)})}}else{jQuery("select.required, input.required").each(function(b){""!==jQuery(this).val()&&null!==jQuery(this).val()||jQuery(this).is(":hidden")||(a++,addError(jQuery(this).attr("id"),"Please fill in this field"),modalShowError("Please fill in this field - "+jQuery(this).attr("id")))}),j=$("input[name=property_style]:checked").data("title"),(0!==u.length||jQuery("#s2id_property_bladesize").is(":hidden"))&&null!==u&&(""!==u|| -1!=j.indexOf("Solid"))||(a++,k++,$("#s2id_property_bladesize").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_bladesize",error_text="Louvre Size is empty"),modalShowErrorNoWarranty(error_text)),0!==aa.length||jQuery("#s2id_property_room_other").is(":hidden")||(k++,a++,alert("No room name"),addError("property_room_other",error_text="Room Name is empty"),modalShowErrorNoWarranty(error_text)),0!==ab.length||jQuery("#s2id_property_stile").is(":hidden")||(a++,addError("property_stile",error_text="property stile is empty"),modalShowError(error_text)),null==ac&&"none"!=$("#solidtype").css("display")&&(a++,addError("solidtype",error_text="property stile type is empty"),modalShowError(error_text)),0===S.length&&(a++,addError("property_hingecolour",error_text="Property hingecolour is empty"),modalShowError(error_text)),0===T.length&&(a++,addError("property_shuttercolour",error_text="Property shuttercolour is empty"),modalShowError(error_text));var V=$("#property_shuttercolour").select2("data").value,W=$('input[name="property_stile"]:checked').attr("data-title");(V.includes("brushed")||V.includes("BRUSHED"))&&(void 0===W||W.includes("51mm")||(showErrorModal("Shutter Colour","Brushed Shutter Colour need to have Frame Stile with 51mm. "),a++,addError("property_shuttercolour",error_text="Brushed Shutter Colour need to have Frame Stile with 51mm"),modalShowError(error_text))),"171"==$("input[name=property_frametype]:checked").val()&&(0===A||""===A||null===A)&&(a++,addError("property_blackoutblindcolour",error_text="Property Blackout Blind Colour is empty"),modalShowError(error_text)),0!==U.length||jQuery("#s2id_property_controltype").is(":hidden")||(a++,addError("property_controltype",error_text="Property controltype is empty"),modalShowError(error_text)),(""===t||null===t)&&alert("material must be Selected");var r=parseFloat($("#property_height").val()),j=getStyleTitle(),X=$("#property_controltype").val(),v=parseFloat($("#property_controlsplitheight").val()),H=parseFloat($("#property_controlsplitheight2").val()),g=getPropertyMidrailheight();""==g&&(g=0),isNaN(v)&&(v=0);var I=getPropertyTotHeight(),f="",h=0;-1>j.indexOf("Special")&&(g>1800?(f=f+(error_text="Midrail Height should be below 1800mm")+". ",h++,a++,addError("property_midrailheight",error_text)):g>e-300&&(f=f+(error_text="Midrail Height should be below "+(e-300)+"mm")+". ",h++,a++,addError("property_midrailheight",error_text))),e>=1800&&e<=3e3&& -1==j.indexOf("Tier")&&0==g&& -1>j.indexOf("Combi")&&(""===$("#property_midrailheight").val()||0===$("#property_midrailheight").val())&&($("#property_midrailheight").addClass("required"),f=f+(error_text="Midrail Height should be completed")+". ",h++,a++,addError("property_midrailheight",error_text),modalShowError(error_text)),e>=1800&&e<=3e3&&j.indexOf("Tracked")>=0&&0==g&&($("#property_midrailheight").addClass("required"),f=f+(error_text="Midrail Height should be completed")+". ",h++,a++,addError("property_midrailheight",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&"137"==$("#property_material").val()&&300>parseFloat($("#property_height").val())&&(a++,f=f+(error_text="Height should be at least 300mm")+". ",h++,addError("property_height",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&"187"==$("#property_material").val()&&400>parseFloat($("#property_height").val())&&(a++,f=f+(error_text="Height should be at least 400mm")+". ",h++,addError("property_height",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&250>parseFloat($("#property_height").val())&&(a++,f=f+(error_text="Height should be at least 250mm")+". ",h++,addError("property_height",error_text),modalShowError(error_text));var i=$("input#property_material").val();max_height=2*(panel_height=137==i?1350:1500),j.indexOf("Tier")> -1?r>panel_height&&0==I&&(a++,f+=error_text="T-o-t height required for height more than "+panel_height.toString()+"mm. ",h++,addError("property_totheight",error_text),modalShowError(error_text)):j.indexOf("Solid")> -1?$("#property_midrailheight").removeClass("required"):-1>j.indexOf("Combi")&&r>panel_height&&0==g&&$("#property_midrailheight").hasClass("required")&&(a++,f+=error_text="Midrail height required for height more than "+panel_height.toString()+"mm. ",h++,addError("property_midrailheight",error_text),modalShowError(error_text)),""!=$("#property_height").val()&&parseFloat($("#property_height").val())>max_height&&(a++,f+=error_text="Height should not exceed "+max_height.toString()+"mm. ",h++,addError("property_height",error_text),modalShowError(error_text)),g>0&&g>r-300&&(error_text="Midrail Height should not exceed height of shutter "+(r-300)+"mm. ",a++,addError("property_midrailheight",error_text),modalShowError(error_text)),0==$("input[name=property_frametype]:checked").length&&(a++,$('<span class="error-text">Please select frame type</span>').insertBefore($("#choose-frametype")),addError("property_frametype",error_text="Please select frame type"),modalShowError(error_text)),0==$('input[name="property_style"]:checked').length&&(k++,a++,$("#choose-style").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please select a style for shutter!"),modalShowErrorNoWarranty(error_text="Please select Installation Style"));var c=$("#property_layoutcode").val(),l=$("#property_nr_sections").val();if(l){c="";for(var d=1;d<=l;d++){var s="B";l==d&&(s=""),c=c+$("#property_layoutcode"+d).val()+s}console.log("Individual layout_code: "+c)}var F=$("#property_layoutcode_tracked").val();0==(c=c?c.toUpperCase():F.toUpperCase()).length&&(k++,a++,$("#property_layoutcode").closest(".panel").find(".panel-collapse").collapse("show"),addError("choose-style","Please complete with Layout Code!"),modalShowErrorNoWarranty(error_text="Please complete with Layout Code!")),0==$('input[name="property_trackedtype"]:checked').length&&35==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select Track Installation type</span>').insertBefore($("#trackedtype")),$("#trackedtype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_trackedtype",error_text="Please select Track Installation type"),modalShowErrorNoWarranty(error_text)),0==$('input[name="property_trackedtype"]:checked').length&&37==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select Track Installation type</span>').insertBefore($("#trackedtype")),$("#trackedtype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_trackedtype",error_text="Please select Track Installation type"),modalShowErrorNoWarranty(error_text)),0==$('input[name="property_bypasstype"]:checked').length&&37==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select By-pass Type</span>').insertBefore($("#bypasstype")),$("#bypasstype").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_bypasstype",error_text="Please select By-pass Type"),modalShowErrorNoWarranty(error_text)),0==$('input[name="property_lightblocks"]:checked').length&&37==$('input[name="property_style"]:checked').val()&&(k++,a++,$('<span class="error-text">Please select Light Blocks</span>').insertBefore($("#lightblocks")),$("#lightblocks").closest(".panel").find(".panel-collapse").collapse("show"),addError("property_lightblocks",error_text="Please select Light Blocks"),modalShowErrorNoWarranty(error_text));var J=0,n=0,c=$("#property_layoutcode").val(),l=$("#property_nr_sections").val();if(l){c="";for(var d=1;d<=l;d++){var s="B";l==d&&(s=""),c=c+$("#property_layoutcode"+d).val()+s}console.log("Individual layout_code: "+c)}var F=$("#property_layoutcode_tracked").val();c=c?c.toUpperCase():F.toUpperCase(),counter=0,last_char="",total_panels=0,all_panels=0,tracked_layout_error=!1;var i=$("input#property_material").val(),w=$("input#property_bladesize").val();panel2_width=550,panel2_width=625,panel2_width=625,panel3_width=550,panel2_width=625,panel3_width=550,panel3_width=550;for(var b={panels1:0,panels2:0,panels3:0,multiPanels:0},p="",K="",d=0;d<c.length;d++)all_panels++,0===d&&(p=c.charAt(d)),K=c.charAt(d),console.log("======================================"),console.log("currentCharacter "+K),console.log("lastCharacter "+p),j.indexOf("Tracked")> -1?(b.multiPanels=b.multiPanels+1,console.log("Total Panels finded Tracked : "+total_panels)):"L"!=c.charAt(d)&&"R"!=c.charAt(d)?(last_char=c.charAt(d),console.log("Last Char "+last_char),console.log("Total Panels finded : "+total_panels),console.log("TOTAL PANELS BCTG "+total_panels),console.log(b),console.log("reset total"),total_panels=0,p=c.charAt(d)):K!==p&&0>"BCTG".indexOf(p)?(console.log("Total Panels finded : "+total_panels),console.log("add to array panel1 !!! "),b.panels1=b.panels1+1,total_panels=1,console.log("TOTAL PANELS RL "+b.panels1),console.log(b),console.log("reset total"),p=c.charAt(d)):K!==p&&"BCTG".indexOf(p)>=0?(console.log("add to array panel1 !!! "),console.log(b.panels1),b.panels1=b.panels1+1,total_panels=1,p=c.charAt(d)):(total_panels++,p=c.charAt(d),2===total_panels?(b.panels2=b.panels2+total_panels,console.log("reset arrayPanels1"),b.panels1=b.panels1-1):3===total_panels?(b.panels3=b.panels3+total_panels,console.log("reset arrayPanels2"),b.panels2=b.panels2-(total_panels-1)):total_panels>3&&(b.multiPanels=b.multiPanels+total_panels,console.log("reset arrayPanels3"),b.panels3=b.panels3-(total_panels-1)),0==d&&(b.panels1=1),console.log("TOTAL PANELS same "+total_panels),console.log(b),p=c.charAt(d)),multipanel_singlepanel_width=$("input#property_width").val()/total_panels;console.log(b),n=0,width_shutter=jQuery("#property_width").val();var l=$("#property_nr_sections").val();if(l){width_shutter=0;for(var d=1;d<=l;d++)width_shutter+=parseFloat($("#property_width"+d).val());console.log("width_shutter: "+width_shutter)}if(b.panels1>0){var o=750;187==i&&(o=1500),(139==i||138==i)&&(o=890),(188==i||137==i)&&(o=850),j.indexOf("Solid")> -1&&(o=550),n+=b.panels1*o}if(b.panels2>0){var q=550;(138==i||139==i)&&(q=625),137==i&&(q=500),j.indexOf("Solid")> -1&&(q=550),n+=b.panels2*q}if(b.panels3>0){var q=550;(138==i||139==i)&&(q=625),137==i&&(q=500),j.indexOf("Solid")> -1&&(q=550),n+=b.panels3*q,console.log("arrayPanels.panels3 > 0")}if(b.multiPanels>0){var o=750;187==i&&(o=1500),(139==i||138==i)&&(o=890),(188==i||137==i)&&(o=850),j.indexOf("Solid")> -1&&(o=550),n=b.panels1*o,j.indexOf("Tracked")> -1||(error_text="<br/>Layout code is invalid. No more than 3 consecutive "+last_char+" panels allowed.",a++,h++,f+=error_text,addError("property_layoutcode",error_text),modalShowError(error_text))}if(-1==j.indexOf("Tracked")&&(b.panels1>0&&0===b.panels2&&0===b.panels3&&0===b.multiPanels&&(n<width_shutter&&(console.log("width shutter: "+width_shutter+" width panels max "+n),error_text="<br/>Max width for single panel too high. Max width "+o,a++,addError("property_layoutcode",error_text),modalShowError(error_text)),width_shutter/b.panels1<200&&(error_text="<br/>Min width for single panel too low.",a++,addError("property_layoutcode",error_text),modalShowError(error_text))),(b.panels2>0||b.panels3>0&&0===b.multiPanels)&&(n<width_shutter&&(error_text="<br/>Max width for multi-fold panels too high.",a++,console.log("current_max_width: "+n),addError("property_layoutcode",error_text),modalShowError(error_text)),width_shutter/b.panels1+width_shutter/b.panels2+width_shutter/b.panels3<200&&(error_text="<br/>Min width for multi-fold panels too low.",a++,addError("property_layoutcode",error_text),modalShowError(error_text)))),j.indexOf("Tracked")> -1){var q=890;n=b.multiPanels*q,console.log("current_max_width: "+n),n<width_shutter&&(error_text="<br/>Max width for single panel too high.",a++,addError("property_layoutcode",error_text),modalShowError(error_text)),width_shutter/b.multiPanels<200&&(error_text="<br/>Min width for multi-fold panels too low.",a++,addError("property_layoutcode",error_text),modalShowError(error_text)),j.indexOf("Tracked")> -1&&b.multiPanels%2!=0&&(tracked_layout_error=!0),tracked_layout_error&&(a++,addError("property_layoutcode","Tracked shutters require even number of panels per layout code 22"),modalShowError(error_text="Tracked shutters require even number of panels per layout code"))}J=200*all_panels,137==i&&(J=250*all_panels),""!=width_shutter&&width_shutter<=J&&(a++,f+=error_text="Width should be at least "+J+"mm. ",h++,addError("property_width",error_text),modalShowError(error_text)),"Blackout"==shutter_type&&0==(c.match(/t/ig)||[]).length&&0==(c.match(/b/ig)||[]).length&&0==(c.match(/c/ig)||[]).length&&width_shutter>1400&&(a++,addError("property_layoutcode","Shutter and Blackout Blind require a T-post if width is more than 1400mm")),!($indiv=$("#property_nr_sections").val())&&(c.indexOf("B")>0||c.indexOf("C")>0)&& -1==j.indexOf("Bay")&& -1==j.indexOf("Tracked")&&(a++,console.log("errors: "+a),addError("property_layoutcode","Please choose Bay Window style with a layout code containing B or C."));var w=$("input#property_bladesize").val();if("96"==X||"95"==X){var m,L=!1,Y=!1,D=0,E=0,P=0,Q=0;if("47"==w&&(m=890,g>0&&(m=890)),"63"==w&&(m=890,g>0&&(m=890)),"76"==w&&(m=890,g>0&&(m=890)),"89"==w&&(m=890,g>0&&(m=890)),"187"==i&&(m=1500),0==g&&0==I&&r>m)D=0,E=m,L=!0;else if(g>0||I>0){var x=0;g>0&&(x=parseInt(g)),I>0&&(x=parseInt(I));var M=x,Z=r-M;M>m&&Z>m?(L=!0,Y=!0,D=0,E=x,P=x+1,Q=r):(M>m||Z>m)&&(L=!0,M>m?(D=0,E=x):(D=x+1,E=r))}if(g>0&&v>0){var R=Math.abs(g-v);R<=10&&(error_text="<br/>Distance between split height and midrail should be more than 10mm",a++,h++,f+=error_text,addError("property_controlsplitheight",error_text))}if(g>0&&parseInt(H)>0){var R=Math.abs(g-parseInt(H));R<=10&&(error_text="<br/>Distance between split height 2 and midrail should be more than 10mm",a++,h++,f+=error_text,addError("property_controlsplitheight2",error_text))}L&&($("#property_controltype").select2("val",95),$("#control-split-height").show(),0==parseInt(v)&&(error_text="<br/>Split height is required for "+w+"mm and height "+r+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight",error_text)),v>E&&(error_text="<br/>Split height should be less than "+E+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight",error_text)),v<D&&(error_text="<br/>Split height should be more than "+D+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight",error_text))),Y?($("#property_controltype").select2("val",95),$("#control-split-height").show(),$("#property_controlsplitheight2").show(),0==parseInt(H)&&(error_text="<br/>Second split height is required for "+w+"mm and height "+r+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight2",error_text)),H>Q&&(error_text="<br/>Second split height should be less than "+Q+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight2",error_text)),H<P&&(error_text="<br/>Second split height should be more than "+P+"mm",a++,h++,f+=error_text,addError("property_controlsplitheight2",error_text))):$("#property_controlsplitheight2").hide()}if($("input[name=property_style]:checked").length>0&&(j=$("input[name=property_style]:checked").data("title")).indexOf("Shaped")> -1&&(existingShapeFile=$("#provided-shape").html().trim(),newShapeFile=$("#attachment").val(),newDrawFile=$("#attachment_draw").val(),""==existingShapeFile&&""==newShapeFile&&""==newDrawFile&&(a++,addError("shape-upload-container",'Please provide the desired shape for style "Shaped & French Cut Out"'))),$("#canvas_container1 svg").length>0&&$("#shutter_svg").html($("#canvas_container1").html()),139==t||138==t||188==t?(y>1800&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than 1800")),y>e-300&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than "+e-300)),z>2700&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than 2700")),z>e-300&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than "+e-300)),B>3e3&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than 3000")),B>e-300&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than "+e-300)),C>3e3&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than 3000")),C>e-300&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than "+e-300))):137==t?(y>1500&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than 1500")),y>e-300&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than "+e-300)),z>2400&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than 2400")),z>e-300&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than "+e-300)),B>2700&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than 2700")),B>e-300&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than "+e-300)),C>2700&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than 2700")),C>e-300&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than "+e-300))):187==t&&(y>1500&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than 1500")),y>e-300&&jQuery("#property_midrailheight").is(":visible")&&(a++,modalShowError("Midrail Height should be less than "+e-300)),z>2700&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than 2700")),z>e-300&&jQuery("#property_midrailheight2").is(":visible")&&(a++,modalShowError("Midrail Height 2 should be less than "+e-300)),B>3e3&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than 3000")),B>e-300&&jQuery("#property_midraidevider1").is(":visible")&&(a++,modalShowError("Midrail divider1 should be less than "+e-300)),C>3e3&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than 3000")),C>e-300&&jQuery("#property_midraidevider2").is(":visible")&&(a++,modalShowError("Midrail divider2 should be less than "+e-300))),console.log("errors_no_warranty "+k),0===a&&0===k){var N=jQuery("#add-product-single-form").serialize(),O=jQuery("#canvas_container1").html(),G="/wp-content/plugins/shutter-module/ajax/ajax-prod-update.php",l=$("#property_nr_sections").val();l&&(G="/wp-content/plugins/shutter-module/ajax/ajax-prod-update-individual.php"),$.ajax({method:"POST",url:G,data:{prod:N,svg:O}}).done(function(a){console.log(a),alert("Shutter updated to order! 5"),window.location.replace(document.referrer)})}}$.getJSON("/wp-content/plugins/shutter-module/ajax/shutter-values.php",function(){}).done(function(a){localStorage.setItem("prop_val",JSON.stringify(a));var b=JSON.stringify(a);return sessionStorage.prop_val=JSON.stringify(a),b}),localStorage.getItem("prop_val")}),jQuery("#add-product-single-form .btn.btn-primary.submit-batten").on("click",function(e){e.preventDefault(),resetErrors();var b=jQuery("#property_width").val(),c=jQuery("#property_height").val(),d=jQuery("#property_depth").val(),f=jQuery("#property_room_other").val(),a=jQuery("#property_material").val();if(console.log("id_material: "+a),console.log('parseFloat(jQuery("#property_height").val()) '+parseFloat(jQuery("#property_height").val())),console.log(!0),3>parseFloat(d)&&(188==a||137==a))addError("property_depth",error_text="The minimum size of the batten can not be less than 3mm."),modalShowError(error_text);else if(3>parseFloat(c)&&(188==a||137==a))addError("property_height",error_text="The minimum size of the batten can not be less than 3mm."),modalShowError(error_text);else if(3>parseFloat(b)&&(188==a||137==a))addError("property_width",error_text="The minimum size of the batten can not be less than 3mm."),modalShowError(error_text);else if(5>parseFloat(c)&&(138==a||139==a||187==a))addError("property_height",error_text="The minimum size of the batten can not be less than 5mm."),modalShowError(error_text),console.log("property_height The minimum size of the batten can not be less than 5mm.");else if(5>parseFloat(b)&&(138==a||139==a||187==a))addError("property_width",error_text="The minimum size of the batten can not be less than 5mm."),modalShowError(error_text),console.log("property_width The minimum size of the batten can not be less than 5mm.");else if(5>parseFloat(d)&&(138==a||139==a||187==a))addError("property_depth",error_text="The minimum size of the batten can not be less than 5mm."),modalShowError(error_text),console.log("property_depth The minimum size of the batten can not be less than 5mm.");else if(""===b||""===c||""===d||""===f)alert("Please compplete all the properties fields");else{var g=jQuery("#add-product-single-form").serialize();$.ajax({method:"POST",url:"/wp-content/plugins/shutter-module/ajax/ajax-batten.php",data:{prod:g}}).done(function(a){console.log(a),alert("Batten added!"),jQuery(".show-prod-info").html(a);var b=jQuery('input[name="edit_customer"]').val(),c=jQuery('input[name="order_edit"]').val();setTimeout(function(){0!==b.length&&0!==c.length?window.location.replace(document.referrer):window.location.replace("/checkout")},500)})}}),jQuery(".print-drawing").click(function(){var a=window.open("","PRINT","height=700,width=800");return a.document.write("<html><head><title>"+document.title+"</title>"),a.document.write("</head><body >"),a.document.write("<h1>"+document.title+"</h1>"),a.document.write(document.getElementById("canvas_container1").innerHTML),a.document.write("</body></html>"),a.document.close(),a.focus(),a.print(),a.close(),!0}),jQuery(document).ready(function(){for(var a=0;a<6;a++){if(0!=jQuery("#property_t"+a).length){var b=jQuery("#t"+a).val();jQuery("#property_t"+a).val(b)}if(0!=jQuery("#property_b"+a).length){var c=jQuery("#b"+a).val();jQuery("#property_b"+a).val(c)}}jQuery("#property_layoutcode").val()&&jQuery("#property_layoutcode").val().toUpperCase(),setTimeout(function(){if(jQuery("#property_frametype").val()){var a=jQuery("#property_frametype").val();144==a?jQuery('input[value="144"]').attr("checked"):143==a&&jQuery('input[value="143"]').attr("checked")}},2e3)}),jQuery("#property_material").change(function(){var a=jQuery(this).val();187==a?(jQuery("#stile-img-earth").show(),jQuery("#stile-img-supreme").hide(),jQuery("#stile-img-biowood").hide(),jQuery("#stile-img-green").hide(),jQuery(".type-img-earth").show(),jQuery(".type-img-supreme").hide(),jQuery(".type-img-biowood").hide(),jQuery(".type-img-green").hide(),jQuery(".type-img-ecowood").hide()):139==a?(jQuery("#stile-img-supreme").show(),jQuery("#stile-img-earth").hide(),jQuery("#stile-img-ecowood").hide(),jQuery("#stile-img-biowood").hide(),jQuery("#stile-img-green").hide(),jQuery(".type-img-supreme").show(),jQuery(".type-img-earth").hide(),jQuery(".type-img-biowood").hide(),jQuery(".type-img-green").hide(),jQuery(".type-img-ecowood").hide()):138==a?(jQuery("#stile-img-biowood").show(),jQuery("#stile-img-supreme").hide(),jQuery("#stile-img-earth").hide(),jQuery("#stile-img-ecowood").hide(),jQuery("#stile-img-green").hide(),jQuery(".type-img-biowood").show(),jQuery(".type-img-supreme").hide(),jQuery(".type-img-earth").hide(),jQuery(".type-img-green").hide(),jQuery(".type-img-ecowood").hide()):137==a?(jQuery("#stile-img-green").show(),jQuery("#stile-img-supreme").hide(),jQuery("#stile-img-biowood").hide(),jQuery("#stile-img-earth").hide(),jQuery("#stile-img-ecowood").hide(),jQuery(".type-img-green").show(),jQuery(".type-img-supreme").hide(),jQuery(".type-img-biowood").hide(),jQuery(".type-img-earth").hide(),jQuery(".type-img-ecowood").hide()):188==a&&(jQuery("#stile-img-ecowood").show(),jQuery("#stile-img-supreme").hide(),jQuery("#stile-img-biowood").hide(),jQuery("#stile-img-earth").hide(),jQuery("#stile-img-green").hide(),jQuery(".type-img-ecowood").show(),jQuery(".type-img-green").hide(),jQuery(".type-img-supreme").hide(),jQuery(".type-img-biowood").hide(),jQuery(".type-img-earth").hide())}),jQuery(document).ready(function(){jQuery("#property_frametype").val(),143==jQuery("#property_frametype").val()&&jQuery('input[name="property_frametype"][value="143"]').click(),144==jQuery("#property_frametype").val()&&jQuery('input[name="property_frametype"][value="144"]').click(),jQuery("select#buildout-select").change(function(){"flexible"===jQuery(this).val()?(jQuery('input[name="property_b_buildout1"]').prop("checked",!1),jQuery(".pull-left.extra-column-buildout.property_b_buildout1").hide()):jQuery(".pull-left.extra-column-buildout.property_b_buildout1").show()})})